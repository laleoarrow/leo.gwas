[{"path":"https://laleoarrow.github.io/leo.gwas/articles/installation.html","id":"aim","dir":"Articles","previous_headings":"","what":"Aim","title":"Installation Tutorial","text":"Install leo.gwas robust path first, use fallback commands specific dependencies fail.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/articles/installation.html","id":"recommended-path-2026-02","dir":"Articles","previous_headings":"","what":"Recommended path (2026-02)","title":"Installation Tutorial","text":"","code":"options(timeout = 1000000)  # 1) Install pak install.packages(\"pak\", repos = \"https://cloud.r-project.org\")  # 2) Install leo.basic pak::pkg_install(\"laleoarrow/leo.basic\")  # 3) Use leo.basic helper to install leo.gwas dependencies with multiple CPU cores leo.basic::install_deps(\"leo.gwas\", ncpus = 8)  # 4) Install leo.gwas pak::pkg_install(\"laleoarrow/leo.gwas\")"},{"path":"https://laleoarrow.github.io/leo.gwas/articles/installation.html","id":"fallback-commands-for-common-failures","dir":"Articles","previous_headings":"","what":"Fallback commands for common failures","title":"Installation Tutorial","text":"dependency resolution still unlucky, run following manually retry leo.gwas installation.","code":"# MR-related dependencies remotes::install_github(\"MRCIEU/TwoSampleMR\")  # PLINK helper (optional; needed for local clumping workflows) # This package may occasionally fail on CI/source unpack in some environments. devtools::install_github(\"explodecomputer/plinkbinr\")  # Bioconductor dependency example BiocManager::install(\"minfi\")  # CatBoost (official binary-installation page) # https://catboost.ai/docs/en/installation/r-installation-binary-installation  # Recommended binary install command as of 2026-02 (macOS universal2) pak::pak(\"url::https://github.com/catboost/catboost/releases/download/v1.2.8/catboost-R-darwin-universal2-1.2.8.tgz\")  # Equivalent remotes command example remotes::install_url(   \"https://github.com/catboost/catboost/releases/download/v1.2.8/catboost-R-darwin-universal2-1.2.8.tgz\",   INSTALL_opts = c(\"--no-multiarch\", \"--no-test-load\", \"--no-staged-install\") )  # ggrastr fallback devtools::install_github(\"VPetukhov/ggrastr\", build_vignettes = FALSE)"},{"path":"https://laleoarrow.github.io/leo.gwas/articles/installation.html","id":"verify-installation","dir":"Articles","previous_headings":"","what":"Verify installation","title":"Installation Tutorial","text":"library(leo.gwas) packageVersion(\"leo.gwas\") run successfully, installation complete.","code":"library(leo.gwas) packageVersion(\"leo.gwas\")"},{"path":"https://laleoarrow.github.io/leo.gwas/articles/installation.html","id":"notes","dir":"Articles","previous_headings":"","what":"Notes","title":"Installation Tutorial","text":"catboost, caret, plinkbinr, genomics packages optional specific functions. function reports missing package errors, install package rerun.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ao Lu. Author, maintainer, copyright holder.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lu (2026). leo.gwas: Layered Exploratory Omics (LEO). R package version 0.0.2, https://laleoarrow.github.io/leo.gwas/.","code":"@Manual{,   title = {leo.gwas: Layered Exploratory Omics (LEO)},   author = {Ao Lu},   year = {2026},   note = {R package version 0.0.2},   url = {https://laleoarrow.github.io/leo.gwas/}, }"},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"layered-exploratory-omics-leo---leogwas","dir":"","previous_headings":"","what":"Layered Exploratory Omics (LEO)","title":"Layered Exploratory Omics (LEO)","text":"Unveiling Depths Genomic Data, Layer Layer.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Layered Exploratory Omics (LEO)","text":"Layered Exploratory Omics (LEO) tool specifically designed deep analysis genomic data. employs multi-layered exploratory approach help researchers (mostly ) uncover complex biological information hidden behind data. Combining cutting-edge statistical computational methodologies, LEO offers user-friendly interface powerful data-processing capabilities, enabling users ranging beginners advanced effectively explore analyze omics data.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"development-status","dir":"","previous_headings":"","what":"Development Status","title":"Layered Exploratory Omics (LEO)","text":"LEO currently early stages development. welcome feedback developers, researchers, users help improve product. Please note features may fully stable yet, interfaces may change based user feedback.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"download","dir":"","previous_headings":"","what":"Download","title":"Layered Exploratory Omics (LEO)","text":"","code":"devtools::install_github(\"laleoarrow/leo.gwas\", dependencies = TRUE) # or pak::pkg_install(\"laleoarrow/leo.gwas\", dependencies = TRUE)"},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"how-to-contribute","dir":"","previous_headings":"","what":"How to Contribute","title":"Layered Exploratory Omics (LEO)","text":"encourage welcome contributions LEO community. interested contributing code documentation, please contact submitting issue.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Layered Exploratory Omics (LEO)","text":"LEO proprietary software. rights reserved. Please refer LICENSE file terms restrictions.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"contact-information","dir":"","previous_headings":"","what":"Contact Information","title":"Layered Exploratory Omics (LEO)","text":"information assistance, please contact us Ao Lu.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Layered Exploratory Omics (LEO)","text":"use leo.gwas work, please cite: look forward collaborating researchers developers worldwide advance innovation progress genomic data analysis!","code":"citation(\"leo.gwas\") @Manual{leo.gwas,   title = {leo.gwas: Layered Exploratory Omics (LEO)},   author = {Ao Lu},   year = {2026},   note = {R package version 0.0.2},   url = {https://laleoarrow.github.io/leo.gwas/} }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_exclude.html","id":null,"dir":"Reference","previous_headings":"","what":"Exclude HLA region from genomic summary data — HLA_exclude","title":"Exclude HLA region from genomic summary data — HLA_exclude","text":"function filters entries within HLA region specified chromosome position range. default HLA region set chromosome 6, 25Mb 34Mb. Custom chromosome position bounds can specified.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_exclude.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exclude HLA region from genomic summary data — HLA_exclude","text":"","code":"HLA_exclude(   data,   chromosome_col = \"CHR\",   position_col = \"BP\",   lower_bound = 2.5e+07,   upper_bound = 3.4e+07 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_exclude.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exclude HLA region from genomic summary data — HLA_exclude","text":"data data frame containing genomic data. chromosome_col name column representing chromosome numbers (default CHR). position_col name column representing genomic positions (default BP). lower_bound lower boundary HLA region base pairs (default 25e6). upper_bound upper boundary HLA region base pairs (default 34e6).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_exclude.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exclude HLA region from genomic summary data — HLA_exclude","text":"data frame excluding rows fall within specified HLA region.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_exclude.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Exclude HLA region from genomic summary data — HLA_exclude","text":"","code":"example_data <- data.frame(   SNP = c(\"rs1\", \"rs2\", \"rs3\", \"rs4\"),   CHR = c(6, 6, 6, 7),   POS = c(26000000, 33000000, 35000000, 29000000) ) result_data <- exclude_HLA(example_data, chromosome_col=\"CHR\", position_col=\"POS\") #> Error in exclude_HLA(example_data, chromosome_col = \"CHR\", position_col = \"POS\"): could not find function \"exclude_HLA\" print(result_data) #> Error: object 'result_data' not found"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_get.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract HLA region from genomic summary data — HLA_get","title":"Extract HLA region from genomic summary data — HLA_get","text":"function extracts entries within HLA region specified chromosome position range. default HLA region chromosome 6, 25Mb 34Mb. Users may provide custom chromosome region boundaries.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_get.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract HLA region from genomic summary data — HLA_get","text":"","code":"HLA_get(   data,   chromosome_col = \"CHR\",   position_col = \"BP\",   lower_bound = 2.5e+07,   upper_bound = 3.4e+07 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_get.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract HLA region from genomic summary data — HLA_get","text":"data data frame containing genomic data. chromosome_col name column representing chromosome numbers (default CHR). position_col name column representing genomic positions (default BP). lower_bound lower boundary HLA region base pairs (default 25e6). upper_bound upper boundary HLA region base pairs (default 34e6).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_get.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract HLA region from genomic summary data — HLA_get","text":"data frame including rows within specified HLA region.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/HLA_get.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract HLA region from genomic summary data — HLA_get","text":"","code":"example_data <- data.frame(   SNP = c(\"rs1\", \"rs2\", \"rs3\", \"rs4\"),   CHR = c(6, 6, 6, 7),   POS = c(26000000, 33000000, 35000000, 29000000) ) hla_data <- HLA_get(example_data, chromosome_col=\"CHR\", position_col=\"POS\") print(hla_data) #>   SNP CHR     POS #> 1 rs1   6 2.6e+07 #> 2 rs2   6 3.3e+07"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_TF.html","id":null,"dir":"Reference","previous_headings":"","what":"Across a df to count TRUE and FALSE — across_df_TF","title":"Across a df to count TRUE and FALSE — across_df_TF","text":"function summarizes TRUE FALSE values column data frame.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_TF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Across a df to count TRUE and FALSE — across_df_TF","text":"","code":"across_df_TF(df, type = \"T\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_TF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Across a df to count TRUE and FALSE — across_df_TF","text":"df data frame type \"T\" TRUE counts (default), \"F\" FALSE counts","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_TF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Across a df to count TRUE and FALSE — across_df_TF","text":"data frame number TRUE FALSE values column","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_TF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Across a df to count TRUE and FALSE — across_df_TF","text":"","code":"df <- data.frame(a = c(TRUE, FALSE, TRUE, TRUE), b = c(FALSE, TRUE, TRUE, TRUE)) across_df_TF(df) # Count TRUE (default) #>   a b #> 1 3 3 across_df_TF(df, \"F\") # Count FALSE #>   a b #> 1 1 1"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Across a df to count na — across_df_na","title":"Across a df to count na — across_df_na","text":"function summarize NA values column data frame.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Across a df to count na — across_df_na","text":"","code":"across_df_na(df)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Across a df to count na — across_df_na","text":"df data frame","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Across a df to count na — across_df_na","text":"data frame number NA values column","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/across_df_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Across a df to count na — across_df_na","text":"","code":"df <- data.frame(a = c(1, 2, NA, 4), b = c(NA, 2, 3, 4)) summarize_na(df) #> Error in summarize_na(df): could not find function \"summarize_na\""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_chrpos.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert rsID to CHR & BP — add_chrpos","title":"Convert rsID to CHR & BP — add_chrpos","text":"function takes dataset column containing rsIDs (SNP IDs) adds corresponding chromosome (CHR) position (POS) information. queries SNPlocs.Hsapiens.dbSNP155.GRCh37 database (GRCh38 specified) retrieve genomic positions. function returns dataframe additional 'CHR' 'POS' columns appended.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_chrpos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert rsID to CHR & BP — add_chrpos","text":"","code":"add_chrpos(dat, snp_col = \"SNP\", ref = \"GRCh37\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_chrpos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert rsID to CHR & BP — add_chrpos","text":"dat dataframe containing least column SNP IDs (rsIDs). snp_col string indicating column name containing SNP IDs (default \"SNP\"). ref string indicating reference genome version. Default \"GRCh37\", can also use \"GRCh38\".","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_chrpos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert rsID to CHR & BP — add_chrpos","text":"dataframe additional 'CHR' 'POS' columns.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_chrpos.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert rsID to CHR & BP — add_chrpos","text":"","code":"pacman::p_load(data.table, dplyr, BSgenome, SNPlocs.Hsapiens.dbSNP155.GRCh37) #> Error in loadNamespace(x): there is no package called ‘pacman’ zuo_ref <- fread(\"/path/to/1KG-EAS-EAF.txt.gz\") # Input dataset with rsID (SNP column) #> Error in fread(\"/path/to/1KG-EAS-EAF.txt.gz\"): could not find function \"fread\" result <- add_chrpos(zuo_ref, snp_col = \"SNP\", ref = \"GRCh37\") #> Error: object 'zuo_ref' not found"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CHR:BP to rsID (not recommended) — add_rsid","title":"Convert CHR:BP to rsID (not recommended) — add_rsid","text":"function takes dataframe must include columns 'CHR' 'BP', appends corresponding rsID querying SNPlocs.Hsapiens.dbSNP155.GRCh37 database. function returns dataframe rsIDs included.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CHR:BP to rsID (not recommended) — add_rsid","text":"","code":"add_rsid(dat, ref = \"GRCh37\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CHR:BP to rsID (not recommended) — add_rsid","text":"dat \"GRCh38\" GRCh38 Ref panel ref str indicating ref version. \"GRCh37\" GRCh37 Ref panel","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert CHR:BP to rsID (not recommended) — add_rsid","text":"dataframe additional 'RefSNP_id' column contains rsIDs.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert CHR:BP to rsID (not recommended) — add_rsid","text":"","code":"pacman::p_load(data.table, BSgenome, leo.gwas) #> Error in loadNamespace(x): there is no package called ‘pacman’ library(\"SNPlocs.Hsapiens.dbSNP155.GRCh37\") # for GRCh37 #> Error in library(\"SNPlocs.Hsapiens.dbSNP155.GRCh37\"): there is no package called ‘SNPlocs.Hsapiens.dbSNP155.GRCh37’ library(\"SNPlocs.Hsapiens.dbSNP155.GRCh38\") # for GRCh38 #> Error in library(\"SNPlocs.Hsapiens.dbSNP155.GRCh38\"): there is no package called ‘SNPlocs.Hsapiens.dbSNP155.GRCh38’ df <- data.frame(   CHR = c(1, 1),   BP = c(15211, 15820) ) result <- add_rsid(df); result #> Error in loadNamespace(x): there is no package called ‘SNPlocs.Hsapiens.dbSNP155.GRCh37’"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid_using_ref.html","id":null,"dir":"Reference","previous_headings":"","what":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","title":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","text":"function takes data frame least chromosome, position, allele columns, matches rsID based local reference file, considering reversed/complement alleles. allows flexibility names allele columns (e.g., 'REF'/'ALT' 'A1'/'A2'). function returns original data frame rsID added first column.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid_using_ref.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","text":"","code":"add_rsid_using_ref(   dat,   local_ref,   chr_col = \"CHR\",   pos_col = \"BP\",   a1_col = \"A1\",   a2_col = \"A2\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid_using_ref.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","text":"dat data frame containing least chromosome, position, allele columns. local_ref data frame containing least 'ID' 'SNP' columns. chr_col Name chromosome column 'dat'. Default 'CHR'. pos_col Name position column 'dat'. Default 'BP'. a1_col Name first allele column 'dat'.  Default 'A1' (e.g., 'A1' 'ALT'). a2_col Name second allele column 'dat'.  Default 'A2' (e.g., 'A2' 'REF').","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid_using_ref.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","text":"original data frame added 'rsID' column first column.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/add_rsid_using_ref.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add rsID based on local reference file (recommended) — add_rsid_using_ref","text":"","code":"if (FALSE) { # \\dontrun{ library(dplyr) # Example data with REF and ALT dat <- data.frame(   CHR = c(7, 12, 4),   BP = c(6013153, 126890980, 40088896),   REF = c(\"G\", \"A\", \"T\"),   ALT = c(\"A\", \"G\", \"A\") ) # Reference data local_ref <- data.frame(   ID = c(\"7:6013153:A:G\", \"12:126890980:G:A\", \"4:40088896:A:T\"),   SNP = c(\"rs10000\", \"rs1000000\", \"rs10000000\") ) result <- add_rsid_using_ref(dat, local_ref, a1_col = \"ALT\", a2_col = \"REF\") print(result)  # Example data with A1 and A2 dat2 <- data.frame(   CHR = c(7, 12, 4),   POS = c(6013153, 126890980, 40088896),   A1 = c(\"A\", \"G\", \"A\"),   A2 = c(\"G\", \"A\", \"T\") ) result2 <- add_rsid_using_ref(dat2, local_ref, pos_col = \"POS\") print(result2) } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/annotate_cpg_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","title":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","text":"function annotates vector CpG site probe IDs retrieving corresponding gene names Illumina 450k annotation package. returns data frame original CpG sites associated gene names.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/annotate_cpg_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","text":"","code":"annotate_cpg_sites(   cpg_vector,   annotation_package = \"IlluminaHumanMethylation450kanno.ilmn12.hg19\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/annotate_cpg_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","text":"cpg_vector character vector CpG site probe IDs annotated. annotation_package character string specifying Illumina annotation package use. can one following: \"IlluminaHumanMethylation450kanno.ilmn12.hg19\" (default) \"IlluminaHumanMethylationEPICanno.ilm10b4.hg19\"","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/annotate_cpg_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","text":"data frame two columns: CpG_Site: original CpG site probe IDs. Gene: associated gene names. NA gene annotation found.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/annotate_cpg_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate CpG Sites with Gene Information — annotate_cpg_sites","text":"","code":"if (FALSE) { # \\dontrun{ library(IlluminaHumanMethylation450kanno.ilmn12.hg19) library(IlluminaHumanMethylationEPICanno.ilm10b4.hg19) # Example CpG probe IDs cpg_ids <- c(\"cg00000029\", \"cg00000108\", \"cg00000109\") # Annotate CpG sites annotate_cpg_sites(cpg_ids, \"IlluminaHumanMethylation450kanno.ilmn12.hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/catboost_prs.html","id":null,"dir":"Reference","previous_headings":"","what":"CatBoost PRS utilities — catboost_prs","title":"CatBoost PRS utilities — catboost_prs","text":"Train, apply, rank CatBoost polygenic risk score (PRS) models.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/catboost_prs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CatBoost PRS utilities — catboost_prs","text":"","code":"catboost_prs(a1_matrix, divide = F, divide_ratio = 0.5)  catboost_prs_target(a1_matrix, model)  catboost_prs_rank(   model,   pool,   pool_df,   types = c(\"FeatureImportance\", \"ShapValues\", \"Interaction\"),   top_k = NULL )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/catboost_prs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CatBoost PRS utilities — catboost_prs","text":"a1_matrix A1 matrix (PHENOTYPE ID columns). divide Logical; split train/val sets. Default FALSE. divide_ratio Numeric; train proportion divide=TRUE. Default 0.5. model Trained CatBoost model. pool CatBoost pool. pool_df Data used build pool. types Character; \"FeatureImportance\",\"ShapValues\",\"Interaction\". top_k Integer; top features keep. Default NULL.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/catboost_prs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CatBoost PRS utilities — catboost_prs","text":"function returns list; contents depend task (training, target prediction, ranking).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/catboost_prs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CatBoost PRS utilities — catboost_prs","text":"functions require installed catboost. Training divide = TRUE also requires caret stratified data splitting.","code":""},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/check_significant_SNP.html","id":null,"dir":"Reference","previous_headings":"","what":"locate the significant SNP for conditional analysis — check_significant_SNP","title":"locate the significant SNP for conditional analysis — check_significant_SNP","text":"locate significant SNP conditional analysis","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/check_significant_SNP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"locate the significant SNP for conditional analysis — check_significant_SNP","text":"","code":"check_significant_SNP(x, environment.list, significance_level = 5e-08)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/check_significant_SNP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"locate the significant SNP for conditional analysis — check_significant_SNP","text":"x data.frame SNP information environment.list tibble environment list (see example usage) significance_level numeric, significance level, default 5e-8","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/check_significant_SNP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"locate the significant SNP for conditional analysis — check_significant_SNP","text":"message informs user independant SNP following conditional analysis","code":""},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/check_significant_SNP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"locate the significant SNP for conditional analysis — check_significant_SNP","text":"","code":"con_dir <- \"/Users/leoarrow/project/VKH2024/data/zuo/con_su\" # specify the directory to store the HLA original data and subsequent conditional analysis results data files <- list.files(con_dir,full.names = T) %>% as.vector(); files # update it each time #> Error in list.files(con_dir, full.names = T) %>% as.vector(): could not find function \"%>%\" x1 <- fread(files[1]) %>% arrange(desc(CHISQ)); head(x1) # ! for the first one, just read the data and sort it by CHISQ/P value #> Error in fread(files[1]) %>% arrange(desc(CHISQ)): could not find function \"%>%\" x2 <- fread(files[2]) %>% arrange(P) # repeat it until no more independent signal can be found. #> Error in fread(files[2]) %>% arrange(P): could not find function \"%>%\" x3 <- fread(files[3]) %>% arrange(P) #> Error in fread(files[3]) %>% arrange(P): could not find function \"%>%\" x4 <- fread(files[4]) %>% arrange(P) #> Error in fread(files[4]) %>% arrange(P): could not find function \"%>%\" x5 <- fread(files[5]) %>% arrange(P) #> Error in fread(files[5]) %>% arrange(P): could not find function \"%>%\" x6 <- fread(files[6]) %>% arrange(P) #> Error in fread(files[6]) %>% arrange(P): could not find function \"%>%\" x7 <- fread(files[7]) %>% arrange(P) #> Error in fread(files[7]) %>% arrange(P): could not find function \"%>%\" x8 <- fread(files[8]) %>% arrange(P) #> Error in fread(files[8]) %>% arrange(P): could not find function \"%>%\"  env <- ls() # get the environment; this line if were put in main func will lead to error. environment.list <- tibble(item = as.vector(grep(\"^x[0-9]+$\", x = env, value = TRUE))) # load the environment #> Error in tibble(item = as.vector(grep(\"^x[0-9]+$\", x = env, value = TRUE))): could not find function \"tibble\" check_significant_SNP(x8, environment.list, significance_level = 5e-8) #> Error: object 'environment.list' not found  # You can mannually check the p-value of one SNP in previous environment.list"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/chisq_p_value.html","id":null,"dir":"Reference","previous_headings":"","what":"Give precise p-value for chi-square test — chisq_p_value","title":"Give precise p-value for chi-square test — chisq_p_value","text":"Sometimes get p-value 0 perform chi-square test analysis. p-value small R rounds 0. function gives precise p-value.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/chisq_p_value.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Give precise p-value for chi-square test — chisq_p_value","text":"","code":"chisq_p_value(chisq_value, df, digits = 4, prec = 100)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/chisq_p_value.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Give precise p-value for chi-square test — chisq_p_value","text":"chisq_value numeric, chi-square value df numeric, degree freedom digits numeric, digits output illustrate prec numeric, precision mpfr() function","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/chisq_p_value.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Give precise p-value for chi-square test — chisq_p_value","text":"precise p-value scientific format","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/chisq_p_value.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Give precise p-value for chi-square test — chisq_p_value","text":"","code":"# install.packages(\"Rmpfr\") library(Rmpfr) #> Error in library(Rmpfr): there is no package called ‘Rmpfr’ chisq_value <- 2629; df <- 1 p_value <- chisq_p_value(chisq_value, df) #> Error in mpfr(log_p_value, prec = prec): could not find function \"mpfr\" print(p_value) #> Error: object 'p_value' not found"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clean_symbols.html","id":null,"dir":"Reference","previous_headings":"","what":"Process and clean gene symbols — clean_symbols","title":"Process and clean gene symbols — clean_symbols","text":"Process clean gene symbols","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clean_symbols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process and clean gene symbols — clean_symbols","text":"","code":"clean_symbols(x)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clump_data_local.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform LD Clumping Locally or via Reference Panel — clump_data_local","title":"Perform LD Clumping Locally or via Reference Panel — clump_data_local","text":"function performs LD clumping using either local PLINK binary file (bfile) 1000 Genomes super population panel. Requires ieugwasr plinkbinr packages.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clump_data_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform LD Clumping Locally or via Reference Panel — clump_data_local","text":"","code":"clump_data_local(   dat,   pop = NULL,   bfile = NULL,   clump_kb = 10000,   clump_r2 = 0.001,   plink_bin = plinkbinr::get_plink_exe() )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clump_data_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform LD Clumping Locally or via Reference Panel — clump_data_local","text":"dat Data frame columns SNP, pval.exposure; optional id.exposure. pop 1000G super-pop online clumping (AFR/AMR/EAS/EUR/SAS). Used bfile NULL. bfile PLINK reference panel prefix local clumping (without .bed/.bim/.fam). set, pop ignored. clump_kb Window size kb. Default 10000. clump_r2 r^2 threshold. Default 0.001. plink_bin Path PLINK executable (auto-detect via plinkbinr NULL bfile set).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/clump_data_local.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform LD Clumping Locally or via Reference Panel — clump_data_local","text":"","code":"# Reference: # - https://github.com/MRCIEU/TwoSampleMR/issues/173 # - https://blog.csdn.net/xiaozheng1213/article/details/126269969 library(ieugwasr) #> OpenGWAS updates: #>   Date: 2024-05-17 #>   [>] OpenGWAS is growing! #>   [>] Please take 2 minutes to give us feedback - #>   [>] It will help directly shape our emerging roadmap #>   [>] https://forms.office.com/e/eSr7EFAfCG library(plinkbinr) # devtools::install_github(\"explodecomputer/plinkbinr\") #> Error in library(plinkbinr): there is no package called ‘plinkbinr’ plinkbinr::get_plink_exe() #> Error in loadNamespace(x): there is no package called ‘plinkbinr’  # Note: after using this, please check `leo_clump` column to see if they are all TRUE # If it's contains F, it means no SNPs remained after clumping or something bad happened"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_1outcome.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","title":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","text":"Combine .fdr files one multiple outcomes (seperately)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_1outcome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","text":"","code":"combine_smr_res_1outcome(   dir,   outcome,   out_dir = file.path(dir, \"combine_1outcome\") )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_1outcome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","text":"dir Character. parent folder contains subfolders fdr files. outcome Character character vector. One outcomes search file names. out_dir Character. Output folder; default create \"combine_1outcome\" dir.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_1outcome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","text":"","code":"NULL. This function writes combined files to disk directly."},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_1outcome.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine .fdr files for one or multiple outcomes (seperately) — combine_smr_res_1outcome","text":"","code":"if (FALSE) { # \\dontrun{ combine_smr_res_1outcome(\"/Users/leoarrow/project/iridocyclitis/output/smr\", \"iri3\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_chr.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine SMR Results for All Chromosomes — combine_smr_res_chr","title":"Combine SMR Results for All Chromosomes — combine_smr_res_chr","text":"function combines SMR (Summary-data-based Mendelian Randomization) result files across chromosomes unique exposure outcome pair (Yes, can deal multiple exposure one dir say, 49 sqtl GTEx). combined results saved specified output directory.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_chr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine SMR Results for All Chromosomes — combine_smr_res_chr","text":"","code":"combine_smr_res_chr(dir, out_dir = \"\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_chr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine SMR Results for All Chromosomes — combine_smr_res_chr","text":"dir Character. directory containing SMR result files. Files follow naming convention exposure_chrX@outcome.smr, X represents chromosome number. out_dir Character. output directory combined SMR files saved. specified, defaults subdirectory named chr_combined within dir.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/combine_smr_res_chr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine SMR Results for All Chromosomes — combine_smr_res_chr","text":"","code":"if (FALSE) { # \\dontrun{ # Combine SMR results in the \"data/smr_results\" directory and save to default output directory combine_smr_res_chr(dir = \"data/smr_results\")  # Combine SMR results and specify a custom output directory combine_smr_res_chr(dir = \"data/smr_results\", out_dir = \"data/combined_results\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_calculate.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Correlation between Two Vectors — correlation_calculate","title":"Calculate Correlation between Two Vectors — correlation_calculate","text":"function calculates Spearman (default) Pearson correlation coefficient associated p-value two vectors. automatically handles missing values.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_calculate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Correlation between Two Vectors — correlation_calculate","text":"","code":"correlation_calculate(vector_x, vector_y, method = \"spearman\", ...)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_calculate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Correlation between Two Vectors — correlation_calculate","text":"vector_x numeric vector. vector_y numeric vector length vector_x. method character string specifying correlation method (\"spearman\" \"pearson\"). Defaults \"spearman\". ... Pass cor.test.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_calculate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Correlation between Two Vectors — correlation_calculate","text":"list correlation coefficient p-value.","code":""},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_calculate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Correlation between Two Vectors — correlation_calculate","text":"","code":"vector_x <- c(1, 2, 2, 4, 5) vector_y <- c(5, 6, 7, 8, 7) result <- correlation_calculate(vector_x, vector_y, method = \"pearson\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_draw.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw Correlation between Two Vectors — correlation_draw","title":"Draw Correlation between Two Vectors — correlation_draw","text":"function creates scatter plot visualize correlation two vectors, displaying correlation coefficient p-value plot.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_draw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw Correlation between Two Vectors — correlation_draw","text":"","code":"correlation_draw(   vector_x,   vector_y,   method = \"spearman\",   color_palette = \"npg\",   title = \"Correlation Plot\",   xlab = \"Vector X\",   ylab = \"Vector Y\",   point_size = 1.5,   point_color = \"#BB7CD8\",   point_stroke = 1,   alpha = 0.75,   line_color = \"#BB7CD8\",   line_type = \"dashed\",   line_size = 1.2,   ci_alpha = 0.2,   title_size = 16,   xlab_size = 14,   ylab_size = 14,   axis_text_size = 14,   ... )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_draw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw Correlation between Two Vectors — correlation_draw","text":"vector_x Numeric vector. vector_y Numeric vector length vector_x. method Correlation method: \"spearman\" \"pearson\". Default \"spearman\". color_palette Character scalar vector color palette (kept compatibility). title Plot title. Default \"Correlation Plot\". xlab, ylab Axis labels. Defaults \"Vector X\", \"Vector Y\". point_size Point size. Default 1.5. point_color Fill color points (shape 21). Default \"#BB7CD8\". point_stroke Numeric stroke width point outline. NA, treated 0. Default 1. alpha Point transparency. Default 0.75. line_color, line_type, line_size Trend line color, type, size. Defaults \"#BB7CD8\", \"dashed\", 1.2. ci_alpha Confidence ribbon alpha. Default 0.2. title_size, xlab_size, ylab_size, axis_text_size Font sizes. Defaults 16, 14, 14, 14. ... Additional arguments passed correlation_calculate().","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_draw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw Correlation between Two Vectors — correlation_draw","text":"ggplot2 object.","code":""},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/correlation_draw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw Correlation between Two Vectors — correlation_draw","text":"","code":"vector_x <- c(10, 2, 3, 4, 5) vector_y <- c(5, 6, 7, 8, 7) correlation_draw(vector_x, vector_y, method = \"pearson\", point_size = 10, color_palette = \"npg\") #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the leo.gwas package. #>   Please report the issue to the authors. #> `geom_smooth()` using formula = 'y ~ x'"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_duplicate_element.html","id":null,"dir":"Reference","previous_headings":"","what":"Count or Identify Duplicates in a Vector — count_duplicate_element","title":"Count or Identify Duplicates in a Vector — count_duplicate_element","text":"function counts number duplicate elements vector, returns logical vector indicating elements duplicates.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_duplicate_element.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count or Identify Duplicates in a Vector — count_duplicate_element","text":"","code":"count_duplicate_element(vector, return = \"count\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_duplicate_element.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count or Identify Duplicates in a Vector — count_duplicate_element","text":"vector vector checked duplicates. return string specifying return type: \"count\" number duplicates, \"logi\" logical vector.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_duplicate_element.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count or Identify Duplicates in a Vector — count_duplicate_element","text":"integer representing number duplicates return \"count\", logical vector indicating elements duplicates return \"logi\".","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_duplicate_element.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count or Identify Duplicates in a Vector — count_duplicate_element","text":"","code":"vec <- c(\"a\", \"b\", \"c\", \"a\", \"b\", \"d\") count_duplicate_element(vec, return = \"count\")  # Returns 4 #> [1] 4 count_duplicate_element(vec, return = \"logi\")   # Returns c(TRUE, TRUE, FALSE, TRUE, TRUE, FALSE) #> [1]  TRUE  TRUE FALSE  TRUE  TRUE FALSE"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_matching_elements.html","id":null,"dir":"Reference","previous_headings":"","what":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","title":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","text":"function counts number elements vector contain given pattern, returns logical vector indicating elements match pattern.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_matching_elements.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","text":"","code":"count_matching_elements(vector, pattern, return = \"count\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_matching_elements.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","text":"vector character vector searched. pattern pattern match (regular expression). return string specifying return type: \"count\" number matches, \"logi\" logical vector.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_matching_elements.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","text":"integer representing number matches return \"count\", logical vector indicating elements match pattern return \"logi\".","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/count_matching_elements.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count or Identify Matches of a Pattern in a Vector — count_matching_elements","text":"","code":"vec <- c(\"abc\", \"def\", \"xyz\", \"abcd\") count_matching_elements(vec, \"abc\", return = \"count\")  # Returns 2 #> [1] 2 count_matching_elements(vec, \"abc\", return = \"logi\")   # Returns c(TRUE, FALSE, FALSE, TRUE) #> [1]  TRUE FALSE FALSE  TRUE"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/dr.prs.html","id":null,"dir":"Reference","previous_headings":"","what":"DuoRank PRS (Dr.PRS) — dr.prs","title":"DuoRank PRS (Dr.PRS) — dr.prs","text":"Dr.PRS designed rank importance PRS inputs futher optimazation. takes two none-overlap stage plink file (bfile) machine learning modeling: lasso capture linear relationship catboost capture non-linear relationship also calculated PRS plink using traditional additive model.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/dr.prs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DuoRank PRS (Dr.PRS) — dr.prs","text":"","code":"dr.prs(   stage1_bfile = \"./data/zuo/bed/SNP_for_PRS/VKH-zhonghua-for_prs_snplist\",   stage2_bfile = \"./data/zuo/bed/SNP_for_PRS/VKH-ASA-for_prs_snplist\",   summary_file = \"./output/part1-gwas/prs/snp_for_prs.txt\",   output_dir = \"./output/part1-gwas/prs/b1t2\",   method = c(1, 2, 3),   dr_optimazation = TRUE,   snp_col = \"SNP.meta\",   a1_col = \"A1\",   weight_col = \"OR_Final\",   weight_type = \"OR\",   divide_ratio = 0.7,   iLasso_iteration = 1000,   nfolds = 10,   plink_bin = plinkbinr::get_plink_exe(),   clump = T,   clump_include_hla = F,   clump_param = NULL,   seed = 725 )  combine_rank(rank1, rank2, auc1 = NULL, auc2 = NULL)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/dr.prs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DuoRank PRS (Dr.PRS) — dr.prs","text":"stage1_bfile Path stage1 PLINK binary files. Normally one generates summary data. 1 source individual data available, can split 2 non-overlap datasets. stage2_bfile Path stage2 PLINK binary files, .e., target dataset PRS calculation. summary_file Path summary statistics file data frame containing SNPs, alleles, weights. Note summary contains refined SNP PRS calculation. output_dir Directory save output files. method Integer vector indicating methods use: 1=PLINK, 2=CatBoost, 3=iLasso. Default three methods. snp_col Column name summary statistics SNP IDs (default: \"SNP.meta\"). a1_col Column name summary statistics effect allele (default: \"A1\"). weight_col Column name summary statistics weights (default: \"OR_Final\"). weight_type Type weights, either \"\" (default) \"Beta\". \"\", calculate Beta values. divide_ratio Proportion stage1 data iLasso (default: 0.7). iLasso_iteration Number iterations iLasso model (default: 1000). plink_bin Path PLINK binary executable (default: plinkbinr::get_plink_exe()). clump Place holder future clumping function. clump_include_hla Place holder future clumping function. clump_param Place holder future clumping function. seed Random seed (Default: 725). dr.optimazation Logical, whether perform greedy search optimize PRS based combined rank CatBoost iLasso (default: TRUE).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/dr.prs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DuoRank PRS (Dr.PRS) — dr.prs","text":"list : lasso_importance, catboost_importance, combined_rank greedy_auc_curve (data.frame: kept_snps, auc) final_subset (character vector SNPs) plink_prs_file (path), logs","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/extract_instruments_local.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract instruments locally for MR Analysis — extract_instruments_local","title":"Extract instruments locally for MR Analysis — extract_instruments_local","text":"Filters SNPs p-value threshold performs LD clumping flexible column mapping.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/extract_instruments_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract instruments locally for MR Analysis — extract_instruments_local","text":"","code":"extract_instruments_local(   dat,   p = 5e-08,   pop = NULL,   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"POS\",   effect_allele_col = \"A1\",   other_allele_col = \"A2\",   beta_col = \"BETA\",   se_col = \"SE\",   pval_col = \"P\",   eaf_col = \"EAF\",   N = \"Neff\",   bfile = NULL,   plink_bin = NULL )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/extract_instruments_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract instruments locally for MR Analysis — extract_instruments_local","text":"dat Dataframe containing GWAS summary statistics; change dataframe data.table. p P-value cutoff (default = 5e-8) pop Super-population code LD reference (default = NULL, recommend using loca bfile) phenotype_col Column name phenotype (default = \"Phenotype\") snp_col Column name SNP IDs (default = \"SNP\") chr_col Column name chromosome (default = \"CHR\") pos_col Column name position (default = \"POS\") effect_allele_col Column name effect allele (default = \"A1\") other_allele_col Column name non-effect allele (default = \"A2\") beta_col Column name effect size (default = \"BETA\") se_col Column name standard error (default = \"SE\") pval_col Column name p-values (default = \"P\") eaf_col Column name effect allele frequency (default = \"EAF\") N Column name sample size (default = \"Neff\", set NULL exclude) bfile Path PLINK binary reference panel (default = NULL) plink_bin Path PLINK executable (default = NULL)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/extract_instruments_local.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract instruments locally for MR Analysis — extract_instruments_local","text":"Formatted exposure data ready MR analysis","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/extract_instruments_local.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract instruments locally for MR Analysis — extract_instruments_local","text":"","code":"if (FALSE) { # \\dontrun{ # Custom column names example extract_instruments_local(   dat = gwas_data,   phenotype_col = \"Trait\",   snp_col = \"rsID\",   chr_col = \"Chromosome\",   pos_col = \"Position\" ) } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","title":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","text":"function filters chromosomes SNP within chromosome meets threshold. , chromosome least one SNP meets threshold, SNPs chromosome retained.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","text":"","code":"filter_chr_basedonSNP_p(   df,   chr_col = \"CHR\",   snp_col = \"Variant_ID\",   p_val_col = \"nominal_P_value\",   threshold = 0.00157 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","text":"df data frame containing SNP data. chr_col Character string specifying name chromosome column. Default \"CHR\". snp_col Character string specifying name SNP identifier column. Default \"Variant_ID\". p_val_col Character string specifying name p-value column. Default \"nominal_P_value\". threshold Numeric value specifying p-value threshold. Default 1.57e-3 (Thresh hold HEIDI test).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","text":"filtered data frame .","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Chromosomes Based on SNP P-value Threshold — filter_chr_basedonSNP_p","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union eqtl_data <- data.frame( CHR = c(\"1\", \"1\", \"2\", \"2\", \"3\"), Variant_ID = c(\"rs1\", \"rs2\", \"rs3\", \"rs4\", \"rs5\"), nominal_P_value = c(1e-9, 0.05, 0.2, 1e-7, 0.3) );eqtl_data #>   CHR Variant_ID nominal_P_value #> 1   1        rs1           1e-09 #> 2   1        rs2           5e-02 #> 3   2        rs3           2e-01 #> 4   2        rs4           1e-07 #> 5   3        rs5           3e-01 df_filtered <- filter_chr_basedonSNP_p(   df = eqtl_data,   chr_col = \"CHR\",   snp_col = \"Variant_ID\",   p_val_col = \"nominal_P_value\",   threshold = 5e-8 );df_filtered #> # A tibble: 2 × 3 #>   CHR   Variant_ID nominal_P_value #>   <chr> <chr>                <dbl> #> 1 1     rs1            0.000000001 #> 2 1     rs2            0.05"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p_qtltools.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","title":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","text":"function adds index column input data frame filters chromosomes based whether SNP within chromosome crosses specified threshold. chromosome least one SNP meets threshold, SNPs chromosome retained. Otherwise, SNPs chromosome removed.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p_qtltools.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","text":"","code":"filter_chr_basedonSNP_p_qtltools(   df,   chr_col = \"CHR\",   snp_col = \"Variant_ID\",   gene_col = \"Gene\",   p_val_col = \"nominal_P_value\",   threshold = 0.00157 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p_qtltools.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","text":"df data frame containing SNP data. chr_col Character string specifying name chromosome column. Default \"CHR\". snp_col Character string specifying name SNP identifier column. Default \"Variant_ID\". gene_col Character string specifying name gene column. Default \"Gene\". p_val_col Character string specifying name p-value column. Default \"nominal_P_value\". threshold Numeric value specifying p-value threshold. Default 1.57e-3 (Thresh hold HEIDI test).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p_qtltools.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","text":"filtered data frame added index column.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/filter_chr_basedonSNP_p_qtltools.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Chromosomes Based on SNP P-value Threshold for .qtltoolsnomi files — filter_chr_basedonSNP_p_qtltools","text":"","code":"library(dplyr) eqtl_data <- data.frame( Gene = c(\"G1\", \"G1\", \"G2\", \"G2\", \"G3\"), CHR = c(\"1\", \"1\", \"2\", \"2\", \"3\"), Variant_ID = c(\"rs1\", \"rs2\", \"rs3\", \"rs4\", \"rs5\"), nominal_P_value = c(1e-9, 0.05, 0.2, 1e-7, 0.3) );eqtl_data #>   Gene CHR Variant_ID nominal_P_value #> 1   G1   1        rs1           1e-09 #> 2   G1   1        rs2           5e-02 #> 3   G2   2        rs3           2e-01 #> 4   G2   2        rs4           1e-07 #> 5   G3   3        rs5           3e-01 df_filtered <- filter_chr_basedonSNP_p_qtltools(   df = eqtl_data,   chr_col = \"CHR\",   snp_col = \"Variant_ID\",   p_val_col = \"nominal_P_value\",   threshold = 5e-8 );df_filtered #> # A tibble: 2 × 4 #>   Gene  CHR   Variant_ID nominal_P_value #>   <chr> <chr> <chr>                <dbl> #> 1 G1    1     rs1            0.000000001 #> 2 G1    1     rs2            0.05"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/find_proxy.html","id":null,"dir":"Reference","previous_headings":"","what":"find_proxy — find_proxy","title":"find_proxy — find_proxy","text":"find_proxy finds proxy snp miss iv","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/find_proxy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_proxy — find_proxy","text":"","code":"find_proxy(   miss_iv,   miss_snp,   outcome_snp,   proxy_file = NULL,   proxy_output_path = NULL,   pop = \"EUR\",   gb = \"grch38\",   token = \"\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/find_proxy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find_proxy — find_proxy","text":"miss_iv iv datafram tsmr exposure format, can locate snp outcome miss_snp snp miss_iv; can inferred using miss_iv$SNP outcome_snp str vector containing snp outcome; entire outcome gwas summary statistics proxy_file pre-calculated proxy file path (full); provide proxy file already generated !!! proxy_output_path full path save proxy file using ldlink pop reference panel 1kg (LDlinkR param) gb genome build (LDlinkR param) token token LDlinkR","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/find_proxy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find_proxy — find_proxy","text":"updated missiv proxy.snp proxy.effect.allele proxy..allele r2 col","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/find_proxy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"find_proxy — find_proxy","text":"","code":"# This function can be used when many iv can not locate corresponding snp in the outcome in tsmr analysis miss_iv <- iv[!iv$SNP %in% dat_h$SNP,] # iv is estracted iv via tsmr package;dat_h is a standard output of harmonise_data() #> Error: object 'iv' not found miss_snp <- miss_iv$SNP #> Error: object 'miss_iv' not found outcome_snp <- iri_nc$SNP #> Error: object 'iri_nc' not found proxy_output_path <- \"Full path to where you wanna store the LDlinkR output\"  proxy_iv <- find_proxy(miss_iv, miss_snp, outcome_snp,              proxy_file = \"/Users/leoarrow/project/iridocyclitis/output/tsmr//combined_query_snp_list_grch38.txt\",              proxy_output_path = NULL) #> Error in find_proxy(miss_iv, miss_snp, outcome_snp, proxy_file = \"/Users/leoarrow/project/iridocyclitis/output/tsmr//combined_query_snp_list_grch38.txt\",     proxy_output_path = NULL): could not find function \"find_proxy\"  # bak  proxy_iv$target.snp <- proxy_iv$SNP # target snp #> Error: object 'proxy_iv' not found  proxy_iv$target.A1 <- proxy_iv$effect_allele.exposure #> Error: object 'proxy_iv' not found  proxy_iv$target.A2 <- proxy_iv$other_allele.exposure #> Error: object 'proxy_iv' not found  # replace for tsmr  proxy_iv$SNP <- proxy_iv$proxy.snp #> Error: object 'proxy_iv' not found  proxy_iv$effect_allele.exposure <- proxy_iv$proxy.A1 #> Error: object 'proxy_iv' not found  proxy_iv$other_allele.exposure <- proxy_iv$proxy.A2 #> Error: object 'proxy_iv' not found  iv_f <- bind_rows(non_miss_iv, proxy_iv) # f for final #> Error: object 'non_miss_iv' not found  dat_h_proxy <- harmonise_data(iv_f, out_nc_proxy) #> Error in harmonise_data(iv_f, out_nc_proxy): could not find function \"harmonise_data\"  mr(dat_h_proxy) # nailed it! #> Error in mr(dat_h_proxy): could not find function \"mr\""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/format_outcome.html","id":null,"dir":"Reference","previous_headings":"","what":"format outcome data — format_outcome","title":"format outcome data — format_outcome","text":"format outcome data","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/format_outcome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"format outcome data — format_outcome","text":"","code":"format_outcome(dat, snp = iv$SNP, N = \"Neff\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/format_outcome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"format outcome data — format_outcome","text":"dat dataframe outcome SNP, CHR, POS, A1, A2, EAF, BETA, SE, P, Phenotype, samplesize columns snp str vector iv$SNP N N column name sample size (effective observed)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/format_outcome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"format outcome data — format_outcome","text":"tsmr format outcome dataframe","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/get_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Unique Identifier for Genetic Data — get_id","title":"Get Unique Identifier for Genetic Data — get_id","text":"Get ID using CHR, BP, A2 (REF/Non-effect), A1 (ALT/Effect)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/get_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Unique Identifier for Genetic Data — get_id","text":"","code":"get_id(x, count_A1_A2 = F)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/get_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Unique Identifier for Genetic Data — get_id","text":"x data.frame must contain columns CHR, BP, A2, A1. column represents: CHR: Chromosome (can c(\"chrom\", \"CHR\", \"Chromosome\", \"chromosome\", \"Chr\")) BP/POS: Base pair position (can c(\"pos\", \"POS\", \"position\", \"BP\", \"Position\", \"Bp\")) A2: Reference allele/non-effect allele (can c(\"A2\", \"Allele2\", \"allele2\", \"a2\", \"REF\", \"Ref\", \"ref\", \"Non-effect\")) A1: Alternative allele/effect allele (can c(\"A1\", \"Allele1\", \"allele1\", \"a1\", \"ALT\", \"Alt\", \"alt\", \"Effect\")) count_A1_A2 T, count number characters A1 A2","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/get_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Unique Identifier for Genetic Data — get_id","text":"data.frame additional 'ID' column (count_A1_A2=T, containing unique identifiers character counts A1 A2)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/get_id.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Unique Identifier for Genetic Data — get_id","text":"","code":"df <- data.frame(chrom = c(1, 1, 2), pos = c(12345, 54321, 11111), A1 = c(\"A\", \"T\", \"G\"), A2 = c(\"G\", \"C\", \"A\")) get_id(df); get_id(df, count_A1_A2 = T) #>   chrom   pos A1 A2          ID #> 1     1 12345  A  G 1:12345:G:A #> 2     1 54321  T  C 1:54321:C:T #> 3     2 11111  G  A 2:11111:A:G #>   chrom   pos A1 A2          ID A1_n A2_n #> 1     1 12345  A  G 1:12345:G:A    1    1 #> 2     1 54321  T  C 1:54321:C:T    1    1 #> 3     2 11111  G  A 2:11111:A:G    1    1"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/group_comparison_draw.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","title":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","text":"function creates violin + boxplot visualize distribution continuous variable across groups categorical variable, optional jitter points annotated p-value.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/group_comparison_draw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","text":"","code":"group_comparison_draw(   df,   x_col,   y_col,   vector_x = NULL,   vector_y = NULL,   test_method = \"wilcox\",   title = \"Group Comparison\",   xlab = NULL,   ylab = NULL,   alpha = 0.8,   main_color = \"#BB7CD8\",   violin_fill = main_color,   box_fill = main_color,   box_color = \"black\",   jitter = T,   jitter_size = 2,   jitter_color = \"black\",   drop_na = F,   annotate_n = T,   title_size = 16,   xlab_size = 14,   ylab_size = 14,   axis_text_size = 14 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/group_comparison_draw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","text":"df data frame (optional vectors provided). x_col Name categorical variable df. y_col Name numeric variable df. vector_x Optional categorical vector. vector_y Optional numeric vector. test_method Statistical test: \"wilcox\" (default, Mann–Whitney U test) \"t.test\". title Plot title. xlab, ylab Axis labels. alpha Transparency violin, boxplot jitter. main_color Easy way set vibe. Good luck trying! violin_fill Fill color violin. box_fill Fill color boxplot. box_color Outline color boxplot. jitter Logical, whether show jitter. Default TRUE. jitter_size Size jitter points. Default 2. jitter_color Color jitter points. Default \"black\". drop_na Logical, whether drop NA group x variable. Default FALSE. annotate_n Logical, whether annotate sample size N group. Default TRUE. title_size Font size plot title. Default 16. xlab_size Font size x-axis label. Default 14. ylab_size Font size y-axis label. Default 14. axis_text_size Font size axis text. Default 14.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/group_comparison_draw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","text":"ggplot2 object.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/group_comparison_draw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw Group Comparison for a Continuous Variable — group_comparison_draw","text":"","code":"df <- tibble::tibble(group = rep(c(0,1), each=50), prs = rnorm(100)) group_comparison_draw(df, \"group\", \"prs\")  group_comparison_draw(df, \"group\", \"prs\", annotate_n = TRUE)  group_comparison_draw(vector_x = rep(c(0,1), each=50), vector_y = rnorm(100))  group_comparison_draw(vector_x = rep(c(0,1), each=50), vector_y = rnorm(100), jitter = FALSE)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/gwas_qc_helpers.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper functions for leo.gwas_qc — gwas_qc_helpers","title":"Helper functions for leo.gwas_qc — gwas_qc_helpers","text":"Internal utilities used GWAS QC pipeline.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/gwas_qc_helpers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper functions for leo.gwas_qc — gwas_qc_helpers","text":"","code":"is_complementary(a1st, a2nd)  fetch_indel(df, type = \"both\")  fetch_non_indel(df)  duplicated_SNP_lines(   df,   type = \"rm\",   dup_columns = c(\"SNP\"),   group_columns = dup_columns )  slice1_SNP_lines(df, dup_columns = c(\"SNP\"), group_columns = dup_columns)  fetch_same_direcrtion(df_x2, df_lg)  any_na(df)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/gwas_qc_helpers.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Helper functions for leo.gwas_qc — gwas_qc_helpers","text":"is_complementary(a1st, a2nd) Check two alleles form /T C/G pair. fetch_indel(df, type) Filter indels allele-string length. fetch_non_indel(df) Keep SNPs single-base alleles. duplicated_SNP_lines(df, type, dup_columns, group_columns) Get/remove duplicated SNP rows. slice1_SNP_lines(df, dup_columns, group_columns) Within duplicated groups, keep first row. fetch_same_direcrtion(df_x2, df_lg) Keep -direction effects datasets. any_na(df) Count NAs per column.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/gwas_qc_helpers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper functions for leo.gwas_qc — gwas_qc_helpers","text":"is_complementary: logical vector. fetch_indel, fetch_non_indel, slice1_SNP_lines, duplicated_SNP_lines(\"rm\"): data frame. duplicated_SNP_lines(\"get\"): data frame count column. fetch_same_direcrtion: filtered data frame (df_x2 subset). any_na: named numeric vector NA counts.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/gwas_qc_helpers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper functions for leo.gwas_qc — gwas_qc_helpers","text":"","code":"# Small demo dataset df <- data.frame(   SNP = c(\"rs1\",\"rs2\",\"rs3\",\"rs2\"),   A1  = c(\"A\",\"AT\",\"C\",\"C\"),   A2  = c(\"T\",\"A\",\"G\",\"G\"),   OR  = c(1.2, 0.9, 1.1, 1.1) )  # Complementary alleles is_complementary(\"A\",\"T\")  # TRUE #> Error in is_complementary(\"A\", \"T\"): could not find function \"is_complementary\" is_complementary(\"A\",\"G\")  # FALSE #> Error in is_complementary(\"A\", \"G\"): could not find function \"is_complementary\"  # Indels and non-indels fetch_indel(df, \"both\") #> Error in fetch_indel(df, \"both\"): could not find function \"fetch_indel\" fetch_non_indel(df) #> Error in fetch_non_indel(df): could not find function \"fetch_non_indel\"  # Duplicates by SNP duplicated_SNP_lines(df, \"get\", dup_columns = \"SNP\") #> Error in duplicated_SNP_lines(df, \"get\", dup_columns = \"SNP\"): could not find function \"duplicated_SNP_lines\" slice1_SNP_lines(df, dup_columns = \"SNP\") #> Error in slice1_SNP_lines(df, dup_columns = \"SNP\"): could not find function \"slice1_SNP_lines\"  # Same-direction effects between two datasets df2 <- transform(df, OR = c(1.1, 1.3, 0.8, 1.1)) fetch_same_direcrtion(df, df2) #> The number with opposite effect size：2 #>   SNP A1 A2  OR #> 1 rs1  A  T 1.2 #> 2 rs2  C  G 1.1  # Count NA by column any_na(df) #> SNP  A1  A2  OR  #>   0   0   0   0"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/lasso_prs.html","id":null,"dir":"Reference","previous_headings":"","what":"Iterative Lasso PRS (iLasso) utilities — lasso_prs","title":"Iterative Lasso PRS (iLasso) utilities — lasso_prs","text":"Train, apply visualize iterative Lasso-based PRS models success gating.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/lasso_prs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iterative Lasso PRS (iLasso) utilities — lasso_prs","text":"","code":"lasso_prs(   a1_matrix,   divide_ratio = 0.7,   iterative = 100,   nfolds = 10,   score_type = \"link\",   seed = 725 )  lasso_prs_target(a1_matrix, model, lambda, score_type = \"link\")  lasso_prs_rank(model, rank, auc_history)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/lasso_prs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iterative Lasso PRS (iLasso) utilities — lasso_prs","text":"a1_matrix data.frame; PLINK A1 matrix. divide_ratio numeric; train fraction per iteration (default 0.7). iterative integer; number iterations (default 100) - set 1, regular lasso performed. nfolds integer; CV folds glmnet (default 10). score_type character; \"link\" (linear score, default) \"response\" (probability). seed integer; base random seed (default 725). model Trained glmnet model (target/rank functions). lambda Best lambda CV. rank Feature frequency table. auc_history Tibble iteration results.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/lasso_prs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iterative Lasso PRS (iLasso) utilities — lasso_prs","text":"function returns list: lasso_prs: model, lambda, perf_train, perf_test, success_n, attempts, auc_history, feature_rank lasso_prs_target: pred_df, perf, target_x, target_y lasso_prs_rank: plots feature frequency diagnostics","code":""},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/ld_ps_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Loci_plot: Calculate the LD-matrix (LD r2) for the index SNP — ld_ps_index","title":"Loci_plot: Calculate the LD-matrix (LD r2) for the index SNP — ld_ps_index","text":"Loci_plot: Calculate LD-matrix (LD r2) index SNP","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/ld_ps_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loci_plot: Calculate the LD-matrix (LD r2) for the index SNP — ld_ps_index","text":"","code":"ld_ps_index(   gwas,   index = \"rs999\",   win = 1000,   ld_calculation = T,   bfile = \"/Users/leoarrow/project/ref/1kg.v3/EAS\",   plink_bin = plinkbinr::get_plink_exe() )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/ld_ps_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loci_plot: Calculate the LD-matrix (LD r2) for the index SNP — ld_ps_index","text":"gwas gwas summary data needs select loci calculate r2 index index snp win window size locally calculate r2; set larger want plot; # default calculate 1MB ld_calculation calculate LD locally, defaut T; use F index snp rare variant (MAF<0.01) bfile bfile plink_bin plinkbinr::get_plink_exe() pop applicable 500 snps; dont use anyway","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/ld_ps_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loci_plot: Calculate the LD-matrix (LD r2) for the index SNP — ld_ps_index","text":"loci data calculated r2","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":null,"dir":"Reference","previous_headings":"","what":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"Perform QC GWAS summary stats merging imputed genotyped data, removing duplicates, checking consistency, matching reference panel, filtering DAF/F_U cutoffs, saving results.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"","code":"leo.gwas_qc(   summary_x2_p,   summary_x2_chip_p,   ref_p = \"/Users/leoarrow/Project/ref/1kg_maf/zuo_ref/1KG-EAS-EAF-chrposa2a1.txt.gz\",   save_dir = \"~/Project/BD2025/data/qc/sex_split\",   save_name_prefix = \"bd-ASA-41\",   DAF_cutoff = 0.2,   F_U_cutoff = 0.01 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"summary_x2_p Path imputed summary file (.assoc/.gz). summary_x2_chip_p Path genotyped (chip) summary file. ref_p Path reference panel loaded df save_dir Output directory (default: \"~/Project/BD2025/data/qc/sex_split\"). save_name_prefix Prefix output file names. DAF_cutoff Numeric. Max |DAF| allowed (default 0.2). F_U_cutoff Numeric. Min F_U required (default 0.01).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"return(summary_qc); writes QC results save_dir.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"Major steps: Read standardize imputed & chip data Remove duplicates (keep smallest P genotyped, drop multiple imputed) Merge label GI (imputed/genotyped) Match reference panel compute DAF Filter cutoffs save full / P<1e-6 subsets output Logs step leo_log() dimension, duplication, NA, etc.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo.gwas_qc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GWAS summary QC pipeline (chip + imputed) — leo.gwas_qc","text":"","code":"if (FALSE) { # \\dontrun{ leo.gwas_qc(\"imp.assoc.gz\", \"chip.assoc\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":null,"dir":"Reference","previous_headings":"","what":"Leo batch iterator builder — leo_iterator","title":"Leo batch iterator builder — leo_iterator","text":"Sometimes need handle large number iterations, multi-core parallel computing can tricky—memory usage may grow beyond actually required. function helps batching iterations, process limited number elements time, preventing excessive RAM consumption.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Leo batch iterator builder — leo_iterator","text":"","code":"leo_iterator(elements, batch_size)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Leo batch iterator builder — leo_iterator","text":"elements vector list iterated. batch_size Number elements per batch.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Leo batch iterator builder — leo_iterator","text":"function (arguments). Repeated calls produce successive batches NULL finished.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Leo batch iterator builder — leo_iterator","text":"call returned function yields next batch. Returns NULL elements remain.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_iterator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Leo batch iterator builder — leo_iterator","text":"","code":"# Suppose you have 25 elements and want to batch them in groups of 6 nums <- 1:25 it <- leo_iterator(nums, 6) #> ℹ [17:22:12] Creating batch iterator with 25 elements in total;  batch size = 6 ; total rounds = 5  while (TRUE) {   batch <- it()   if (is.null(batch)) break    # add your parallel process steps   print(batch) } #> ✔ [17:22:12] Round 1 of 5 | elements from index 1 to 6  #> [1] 1 2 3 4 5 6 #> ✔ [17:22:12] Round 2 of 5 | elements from index 7 to 12  #> [1]  7  8  9 10 11 12 #> ✔ [17:22:12] Round 3 of 5 | elements from index 13 to 18  #> [1] 13 14 15 16 17 18 #> ✔ [17:22:12] Round 4 of 5 | elements from index 19 to 24  #> [1] 19 20 21 22 23 24 #> ✔ [17:22:12] Round 5 of 5 | elements from index 25 to 25  #> [1] 25"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"TODO: Merge gene annotation function one simple command. function maps gene symbols genomic positions (chromosome, start, end, strand) using specified method genome assembly.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"","code":"leo_map_GtoCP(   genes,   gene_col = NULL,   method = c(\"bioconductor\", \"gtf\"),   genome = c(\"hg19\", \"hg38\"),   ... )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"genes character vector gene symbols data frame containing gene symbols. gene_col column name gene symbols genes data frame. method method use: \"bioconductor\" \"gtf\". genome genome assembly use: \"hg19\" \"hg38\". ... Additional arguments pass GTF method.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"data frame columns: gene_symbol, chr, bp_start, bp_end, strand.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"function supports two methods: \"bioconductor\": uses Bioconductor packages. See map_gene_to_chrbp_using_TxDb(). \"gtf\": uses GTF file. See map_gene_to_chrbp_using_gtf().","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_map_GtoCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols to Genomic Positions — leo_map_GtoCP","text":"","code":"if (FALSE) { # \\dontrun{ # Using Bioconductor method with a character vector of gene symbols leo_map_GtoCP(genes = c(\"TP53\", \"BRCA1\", \"EGFR\"), method = \"bioconductor\", genome = \"hg19\")  # Using Bioconductor method with a data frame leo_map_GtoCP(genes = data.frame(gene_name = c(\"TP53\", \"BRCA1\", \"EGFR\"), value = c(1.2, 3.4, 5.6)),               gene_col = \"gene_name\", method = \"bioconductor\", genome = \"hg19\")  # Using GTF method with a character vector of gene symbols leo_map_GtoCP(genes = c(\"TP53\", \"BRCA1\", \"EGFR\"), method = \"gtf\", genome = \"hg38\")  # Using GTF method with a data frame leo_map_GtoCP(genes = data.frame(gene_name = c(\"TP53\", \"BRCA1\", \"EGFR\"), value = c(1.2, 3.4, 5.6)),               gene_col = \"gene_name\", method = \"gtf\", genome = \"hg38\", download_dir = \"~/project/ref/gtf\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_scale_color.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Color Palette to ggplot — leo_scale_color","title":"Apply Color Palette to ggplot — leo_scale_color","text":"function applies specified color palette ggplot object, supporting ggsci, RColorBrewer, viridis palettes, well custom colors.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_scale_color.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Color Palette to ggplot — leo_scale_color","text":"","code":"leo_scale_color(plot, color_palette = \"npg\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_scale_color.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Color Palette to ggplot — leo_scale_color","text":"plot ggplot object color palette applied. color_palette character string specifying color palette use. Options include ggsci palettes (\"npg\", \"lancet\", \"jama\", etc.), RColorBrewer palettes, viridis palettes, custom vector colors.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_scale_color.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Color Palette to ggplot — leo_scale_color","text":"ggplot object applied color palette.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust","title":"Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust","text":"applies FDR/Bonferroni corrections single SMR result. corrected results saved fdr subdirectory within output directory.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust","text":"","code":"leo_smr_adjust(   smr_result_path,   writePath = \"\",   out_dir = \"\",   QTL_type = \"\",   Source = \"\",   Tissue = \"\",   Outcome_name = \"\",   add_info_cols = T,   drop_non_heidi = T,   hla = F,   write_out = T )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust","text":"smr_result_path Character. path containing SMR result file. Files .smr extension. writePath  out_dir Character. output directory adjusted files saved. specified, defaults create dir named fdr within dir-name (smr_result_path). QTL_type Character. type QTL SMR analysis. Source Character. name Source. Tissue Character. name Tissue. Outcome_name  add_info_cols Logical. Whether add information columns : QTL_type, Source, Tissue Outcome. Default TRUE. drop_non_heidi Logical. Whether drop Probes without HEIDI test information. Default TRUE. hla Logical. Whether pre-exclude HLA region probes. Default False. write_out Logical. Whether write adjusted results file. Default TRUE.","code":""},{"path":[]},{"path":[]},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust","text":"","code":"if (FALSE) { # \\dontrun{ leo_smr_adjust(\"~/project/iridocyclitis/output/smr-t2d/sqtl/GTEx49/chr_combined/chr_combine_sQTL_Adipose_Subcutaneous@iri3.smr\",                writePath = \"\", out_dir = \"~/project/iridocyclitis/output/smr-t2d/sqtl/GTEx49\") leo_smr_adjust(\"~/project/iridocyclitis/output/smr-t2d/sqtl/GTEx49/chr_combined/chr_combine_sQTL_Adipose_Subcutaneous@iri3.smr\",                writePath = \"./haha.fdr\", out_dir = \"\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust_loop.html","id":null,"dir":"Reference","previous_headings":"","what":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","title":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","text":"function applies FDR/Bonferroni corrections SMR results within specified directory.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust_loop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","text":"","code":"leo_smr_adjust_loop(   dir,   out_dir = \"\",   pattern = \"\\\\.smr$\",   QTL_type,   Source,   ... )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust_loop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","text":"dir Character. directory containing SMR result files. Files .smr extension follow naming convention exposure@outcome.smr. out_dir Character. output directory adjusted SMR files saved. specified, defaults creating fdr directory within input directory. pattern Character. regular expression pattern match SMR result files. Default \"\\.smr$\" (.e., files ending .smr). ... Additional arguments passed leo_smr_adjust.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust_loop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","text":"NULL.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_adjust_loop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Batch Adjust SMR Results with FDR and Bonferroni Corrections — leo_smr_adjust_loop","text":"","code":"if (FALSE) { # \\dontrun{ leo_smr_adjust_loop(dir     = \"~/project/iridocyclitis/output/smr/sqtl/GTEx49/chr_combined\",                     out_dir = \"~/project/iridocyclitis/output/smr/sqtl/GTEx49/fdr\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_extract_sig_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract significant results from .all files — leo_smr_extract_sig_res","title":"Extract significant results from .all files — leo_smr_extract_sig_res","text":"function scans combine_1outcome folder .files, filters rows Pass_FDR == \"Pass\" Pass_Bonferroni == \"Pass\" (depending pass_type argument), writes significant subset new file (e.g., smr_res_YYYYMMDD_iri3.sig.).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_extract_sig_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract significant results from .all files — leo_smr_extract_sig_res","text":"","code":"leo_smr_extract_sig_res(dir, pass_type = c(\"FDR\", \"Bonferroni\"), out_dir = \"\")"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_extract_sig_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract significant results from .all files — leo_smr_extract_sig_res","text":"dir Character. main combine_1outcome folder combine_smr_res_1outcome. pass_type Character. significance criterion use: one c(\"FDR\", \"Bonferroni\", \"\"). - \"FDR\": keep rows Pass_FDR == \"Pass\" - \"Bonferroni\": keep rows Pass_Bonferroni == \"Pass\" - \"\": keep rows either FDR Bonferroni \"Pass\" out_dir Character. write significant results. Default dir/combine_1outcome/sig.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_extract_sig_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract significant results from .all files — leo_smr_extract_sig_res","text":"NULL. Writes .sig.files disk.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_extract_sig_res.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract significant results from .all files — leo_smr_extract_sig_res","text":"","code":"if (FALSE) { # \\dontrun{ # For the directory \"/Users/leoarrow/project/iridocyclitis/output/smr-t2d\", # after running combine_smr_res_1outcome, we have .all files in # \"smr-t2d/combine_1outcome\".  leo_smr_extract_sig_res(   dir       = \"/Users/leoarrow/project/iridocyclitis/output/smr-t2d\",   pass_type = \"FDR\" ) } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_merge_shared_probes.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","title":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","text":"function finds intersected probeID across provided files merges single data frame using inner_join.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_merge_shared_probes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","text":"","code":"leo_smr_merge_shared_probes(   dir = NULL,   file_paths = NULL,   pattern = \"\\\\.sig\\\\.all$\",   out_file = \"\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_merge_shared_probes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","text":"dir Character. directory containing SMR files (e.g. \".sig.\" files). provided, function read matching files directory. file_paths Character vector. set absolute paths SMR files. (Priority dir) non-NULL, dir ignored. pattern Character. Regex pattern searching files dir. Default \"\\.sig\\.$\". out_file Character. empty, write merged result path. Otherwise return R.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_merge_shared_probes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","text":"tibble containing shared probes across specified files. out_file provided, result written disk function returns NULL.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/leo_smr_merge_shared_probes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge multiple SMR files and keep only shared probes for 2 outcomes — leo_smr_merge_shared_probes","text":"","code":"if (FALSE) { # \\dontrun{ # 1) Merge all .sig.all files in a directory: merged_df <- leo_smr_merge_shared_probes(   dir = \"/path/to/smr-t2d/combine_1outcome/sig\" )  # 2) Merge specific files by absolute paths: files_vec <- c(   \"/path/to/smr/combine_1outcome/smr_res_20241230_iri3.all\",   \"/path/to/smr/combine_1outcome/smr_res_20241230_t1d1.all\" ) merged_df <- leo_smr_merge_shared_probes(   file_paths = files_vec,   out_file = \"shared_probes_merged.tsv\" ) } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/locuszoomr_loc.html","id":null,"dir":"Reference","previous_headings":"","what":"Loci_plot: prepare the locus data for locuszoomr — locuszoomr_loc","title":"Loci_plot: prepare the locus data for locuszoomr — locuszoomr_loc","text":"Loci_plot: prepare locus data locuszoomr","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/locuszoomr_loc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loci_plot: prepare the locus data for locuszoomr — locuszoomr_loc","text":"","code":"locuszoomr_loc(loci_data, gene, online_ld = F, index_snp, flank)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/locuszoomr_loc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loci_plot: prepare the locus data for locuszoomr — locuszoomr_loc","text":"loci_data output ld_ps_index gene gene loci online_ld whether use online LD; default F index_snp indexed snp flank flank size locus plot","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/locuszoomr_loc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loci_plot: prepare the locus data for locuszoomr — locuszoomr_loc","text":"prepared data pass save_regional_plot","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_chrbp_using_biomaRt.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","title":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","text":"function uses biomaRt retrieve genomic positions (chr, bp_start, bp_end, strand) Ensembl database based Ensembl gene IDs.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_chrbp_using_biomaRt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","text":"","code":"map_ensg_to_chrbp_using_biomaRt(   ensembl_ids,   ensembl_col = NULL,   genome = c(\"hg19\", \"hg38\"),   verbose = F )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_chrbp_using_biomaRt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","text":"ensembl_ids character vector Ensembl gene IDs, data frame containing information. ensembl_col ensembl_ids data frame, specify column name containing Ensembl gene IDs. genome genome version use: \"hg19\" \"hg38\". verbose Logical indicating whether print unmapped information.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_chrbp_using_biomaRt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","text":"data frame containing genomic position information, including ensembl_gene_id, chr, bp_start, bp_end, strand.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_chrbp_using_biomaRt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Ensembl Gene IDs to Genomic Positions using biomaRt — map_ensg_to_chrbp_using_biomaRt","text":"","code":"if (FALSE) { # \\dontrun{ # Query using Ensembl gene IDs ensembl_ids <- c(\"ENSG00000141510\", \"ENSG00000012048\", \"ENSG00000146648\") map_ensg_to_chrbp_using_biomaRt(ensembl_ids = ensembl_ids, genome = \"hg19\")  # Use a data frame as input gene_df <- data.frame(ensembl_id = ensembl_ids, value = c(1.2, 3.4, 5.6)) map_ensg_to_chrbp_using_biomaRt(ensembl_ids = gene_df, ensembl_col = \"ensembl_id\", genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_biomaRt.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","title":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","text":"function uses biomaRt retrieve gene symbols based Ensembl gene IDs.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_biomaRt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","text":"","code":"map_ensg_to_gene_using_biomaRt(   ensembl_ids,   ensembl_col = NULL,   type = c(\"combine\", \"first\"),   sep = \"/\",   genome = c(\"hg19\", \"hg38\"),   verbose = F )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_biomaRt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","text":"ensembl_ids character vector Ensembl gene IDs, data frame containing information. ensembl_col ensembl_ids data frame, specify column name containing Ensembl gene IDs. type handle cases one Ensembl ID maps multiple gene symbols. Options \"combine\" (default) combine separator \"first\" use first symbol. sep separator deal one ensg mapped multiple gene. Default \"/\". genome genome version use: \"hg19\" \"hg38\". verbose Logical indicating whether print unmapped information.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_biomaRt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","text":"data frame containing Ensembl gene IDs corresponding gene symbols.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_biomaRt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Ensembl Gene IDs to Gene Symbols using biomaRt — map_ensg_to_gene_using_biomaRt","text":"","code":"if (FALSE) { # \\dontrun{ # Query using Ensembl gene IDs ensembl_ids <- c(\"ENSG00000141510\", \"ENSG00000012048\", \"ENSG00000146648\") map_ensg_to_gene_using_biomaRt(ensembl_ids = ensembl_ids, genome = \"hg19\")  # Use a data frame as input gene_df <- data.frame(ensembl_id = ensembl_ids, value = c(1.2, 3.4, 5.6)) map_ensg_to_gene_using_biomaRt(ensembl_ids = gene_df, ensembl_col = \"ensembl_id\", genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_org.Hs.eg.db.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","title":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","text":"function maps Ensembl IDs corresponding gene symbols using org.Hs.eg.db package.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_org.Hs.eg.db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","text":"","code":"map_ensg_to_gene_using_org.Hs.eg.db(ensembl_ids, ensembl_col = NULL)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_org.Hs.eg.db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","text":"ensembl_ids character vector Ensembl IDs data frame containing Ensembl IDs. ensembl_col column name Ensembl IDs ensembl_ids data frame.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_org.Hs.eg.db.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","text":"data frame two columns: input Ensembl IDs corresponding gene symbols.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_gene_using_org.Hs.eg.db.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Ensembl IDs to Gene Symbols using org.Hs.eg.db — map_ensg_to_gene_using_org.Hs.eg.db","text":"","code":"if (FALSE) { # \\dontrun{ ensembl_ids <- c(\"ENSG00000141510.1\", \"ENSG00000012048\", \"ENSG00000146648\") # Example with Ensembl ID vector map_ensg_to_gene_using_org.Hs.eg.db(ensembl_ids = ensembl_ids)  ensembl_ids_df <- data.frame(EnsemblID = ensembl_ids, OtherInformation = c(1,2,3)) # Example with data frame input map_ensg_to_gene_using_org.Hs.eg.db(ensembl_ids = ensembl_ids_df, ensembl_col = \"EnsemblID\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_tss_using_biomaRt.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","title":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","text":"function maps Ensembl gene IDs transcription start sites (TSS). (Note inferred using gene start end information based strand) uses biomaRt specified genome assembly (\"hg19\" \"hg38\").","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_tss_using_biomaRt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","text":"","code":"map_ensg_to_tss_using_biomaRt(   ensembl_ids,   ensembl_col = NULL,   genome = c(\"hg19\", \"hg38\"),   ... )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_tss_using_biomaRt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","text":"ensembl_ids character vector Ensembl gene IDs, data frame containing information. ensembl_col ensembl_ids data frame, specify column name containing Ensembl gene IDs. genome genome version use: \"hg19\" \"hg38\". ... pass map_ensg_to_chrbp_using_biomaRt. See map_ensg_to_chrbp_using_biomaRt()","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_tss_using_biomaRt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","text":"data frame Ensembl gene IDs TSS positions.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_ensg_to_tss_using_biomaRt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Ensembl Gene IDs to TSS Using biomaRt — map_ensg_to_tss_using_biomaRt","text":"","code":"if (FALSE) { # \\dontrun{ ensembl_ids <- c(\"ENSG00000141510\", \"ENSG00000012048\", \"ENSG00000146648\") map_ensg_to_tss_using_biomaRt(ensembl_ids = ensembl_ids, genome = \"hg19\")  ensembl_ids_df <- data.frame(EnsemblID = ensembl_ids, OtherInfo = c(1, 2, 3)) map_ensg_to_tss_using_biomaRt(ensembl_ids = ensembl_ids_df, ensembl_col = \"EnsemblID\", genome = \"hg38\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"使用离线数据框 annotables::grch38 与 annotables::grch37 为基因符号添加 biotype、description，并给出来源列 infer_version（\"grch38\" / \"grch37\" / \"unmapped\"）。","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"","code":"map_gene_class_using_annotables(genes, gene_col = \"Gene\", quiet = FALSE)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"genes Character vector gene symbols，或包含基因符号的数据框/ tibble gene_col 列名（当 genes 为表格时），默认 \"Gene\" quiet 逻辑值；TRUE 时不显示进度信息","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"与输入同结构的数据，附加 biotype、description、infer_version","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"逻辑： 先左连接 grch38；命中则 infer_version = \"grch38\" 未命中者再补 grch37；命中则 infer_version = \"grch37\" 仍未命中者三列均填占位，如上所述","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_annotables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols to biotype & description via annotables — map_gene_class_using_annotables","text":"","code":"if (FALSE) { # \\dontrun{ map_gene_class_using_annotables(c(\"TP53\",\"BRCA1\",\"C14orf37\"))  df <- tibble::tibble(Gene = c(\"TP53\",\"XIST\",\"C14orf37\")) map_gene_class_using_annotables(df, gene_col = \"Gene\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_biomarRt.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","title":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","text":"先连接 Ensembl GRCh38（www.ensembl.org）批量查询 gene_biotype 与 description；未命中的基因再自动回退到 GRCh37（grch37.ensembl.org）。 最终为每个基因追加三列： biotype description infer_version — \"GRCh38\" / \"GRCh37\" / \"unmapped\"","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_biomarRt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","text":"","code":"map_gene_class_using_biomarRt(genes, gene_col = \"Gene\", quiet = FALSE)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_biomarRt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","text":"genes Character vector gene symbols，或包含基因符号的数据框 / tibble gene_col 列名（当 genes 为表格时），默认 \"Gene\" quiet 逻辑值；TRUE 时不显示进度信息","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_biomarRt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","text":"输入同结构的数据，附加 biotype、description、infer_version","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_class_using_biomarRt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols to biotype & description via biomaRt (GRCh38 → GRCh37 fallback) — map_gene_class_using_biomarRt","text":"","code":"if (FALSE) { # \\dontrun{ map_gene_class_using_biomarRt(c(\"TP53\", \"IGHV1-69\", \"TRAC\", \"MIR21\"))  df <- tibble::tibble(Gene = c(\"TP53\",\"XIST\",\"SNORD14A\")) map_gene_class_using_biomarRt(df, gene_col = \"Gene\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_TxDb.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","title":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","text":"Map Gene Symbols Using Bioconductor Packages","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_TxDb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","text":"","code":"map_gene_to_chrbp_using_TxDb(   genes,   gene_col = NULL,   genome = c(\"hg19\", \"hg38\") )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_TxDb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","text":"genes character vector gene symbols data frame containing gene symbols. gene_col column name gene symbols genes data frame. genome genome assembly use: \"hg19\" \"hg38\". hg19, needs \"TxDb.Hsapiens.UCSC.hg19.knownGene\" Bioconductor package hg38, needs \"TxDb.Hsapiens.UCSC.hg38.knownGene\" Bioconductor package","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_TxDb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","text":"data frame mapped results.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_TxDb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols Using Bioconductor Packages — map_gene_to_chrbp_using_TxDb","text":"","code":"if (FALSE) { # \\dontrun{ gene_symbols <- c(\"TP53\", \"BRCA1\", \"EGFR\") # Example with gene symbol vector map_gene_to_chrbp_using_TxDb(genes = gene_symbols, genome = \"hg19\")  gene_symbols_df <- data.frame(GeneName = gene_symbols, OtherInformation = c(1,2,3)) # Example with data frame input map_gene_to_chrbp_using_TxDb(genes = gene_symbols_df, gene_col = \"GeneName\" , genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"function queries gene symbols genomic positions (chromosome, start, end, strand) using Ensembl's biomaRt specified genome assembly (\"hg19\" \"hg38\").","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"","code":"map_gene_to_chrbp_using_biomaRt(   genes,   gene_col = NULL,   genome = c(\"hg19\", \"hg38\") )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"genes character vector gene symbols query, data frame containing gene symbols. gene_col column name gene symbols genes data frame. genome genome assembly use: \"hg19\" \"hg38\".","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"data frame original data new columns: chr, bp_start, bp_end, strand, gene_symbol.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"input data frame, function retains existing columns adds new columns mapping results.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_biomart.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols to Genomic Positions Using biomaRt — map_gene_to_chrbp_using_biomaRt","text":"","code":"if (FALSE) { # \\dontrun{ # Query location of TP53, BRCA1, and EGFR genes gene_symbols <- c(\"TP53\", \"BRCA1\", \"EGFR\") map_gene_to_chrbp_using_biomaRt(genes = gene_symbols, genome = \"hg19\")  # Using a data frame with gene symbols gene_symbols_df <- data.frame(GeneName = gene_symbols, OtherInfo = c(1, 2, 3)) map_gene_to_chrbp_using_biomaRt(genes = gene_symbols_df, gene_col = \"GeneName\", genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_gtf.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","title":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","text":"Map Gene Symbols Using GTF File","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_gtf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","text":"","code":"map_gene_to_chrbp_using_gtf(   genes,   gene_col = NULL,   genome = c(\"hg19\", \"hg38\"),   gtf_file = NULL,   download_dir = \"~/project/ref/gtf\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_gtf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","text":"genes character vector gene symbols data frame containing gene symbols. gene_col column name gene symbols genes data frame. genome genome assembly use: \"hg19\" \"hg38\". gtf_file path GTF file. NULL, function download appropriate GTF file. download_dir path wanna store downloaded gtf file","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_gtf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","text":"data frame mapping results.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_chrbp_using_gtf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols Using GTF File — map_gene_to_chrbp_using_gtf","text":"","code":"if (FALSE) { # \\dontrun{ gene_symbols <- c(\"TP53\", \"BRCA1\", \"EGFR\") map_gene_to_chrbp_using_gtf(genes = gene_symbols, genome = \"hg38\")  gene_symbols_df <- data.frame(GeneName = gene_symbols, OtherInformation = c(1,2,3)) map_gene_to_chrbp_using_gtf(genes = gene_symbols_df, gene_col = \"GeneName\" , genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_ensembl.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","title":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","text":"function provides robust gene symbol Ensembl ID mapping : Local org.Hs.eg.db annotations (default) Ensembl BioMart web service (requires internet)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_ensembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","text":"","code":"map_gene_to_ensembl(   genes,   gene_col = NULL,   method = c(\"org.Hs.eg.db\", \"biomart\"),   genome = c(\"hg19\", \"hg38\"),   type = c(\"first\", \"combine\"),   sep = \"/\",   batch_size = 100 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_ensembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","text":"genes Input containing gene symbols. Can : Character vector gene symbols Data frame containing gene symbol column gene_col Column name containing gene symbols genes data frame method Mapping methodology: \"org.Hs.eg.db\": Local Bioconductor annotations (default) \"biomart\": Ensembl BioMart service genome Genome assembly version (BioMart ): \"hg19\": GRCh37 (default) \"hg38\": GRCh38 type Multi-mapping handling: \"first\": Return first valid ID (default) \"combine\": Concatenate multiple IDs sep Separator combined IDs (default: \"/\") batch_size BioMart query batch size (default: 100)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_ensembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","text":"Data frame original data + ensembl_id column","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_ensembl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Gene Symbols to Ensembl IDs — map_gene_to_ensembl","text":"","code":"if (FALSE) { # \\dontrun{ # Local annotation method genes <- c(\"TP53\", \"BRCA1\", \"VEGFA\") result_local <- map_gene_to_ensembl(genes)  # BioMart with custom parameters gene_df <- data.frame(   my_symbol = c(\"TP53\", \"BRCA1\", \"NONEXISTENT\"),   values = rnorm(3) ) result_biomart <- map_gene_to_ensembl(   gene_df,   gene_col = \"my_symbol\",   method = \"biomart\",   genome = \"hg19\",   batch_size = 50 ) } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_tss_using_gtf.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","title":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","text":"function maps gene symbols transcription start sites (TSS) positions using hg19 hg38 genome assembly.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_tss_using_gtf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","text":"","code":"map_gene_to_tss_using_gtf(   genes,   gene_col = NULL,   genome = c(\"hg19\", \"hg38\"),   gtf_file = NULL,   download_dir = \"~/project/ref/gtf\",   ... )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_tss_using_gtf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","text":"genes character vector gene symbols data frame containing gene symbols. gene_col column name gene symbols genes data frame. genome genome assembly use: \"hg19\" \"hg38\". gtf_file path GTF file. NULL, function download appropriate GTF file. download_dir path want store downloaded gtf file. ... Pass map_gene_to_chrbp_using_gtf. See map_gene_to_chrbp_using_gtf()","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_tss_using_gtf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","text":"data frame gene symbols TSS positions","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/map_gene_to_tss_using_gtf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Genes to Their TSS Positions — map_gene_to_tss_using_gtf","text":"","code":"if (FALSE) { # \\dontrun{ genes <- c(\"TP53\", \"BRCA1\", \"EGFR\") map_gene_to_tss_using_gtf(genes = genes, genome = \"hg38\")  genes_df <- data.frame(GeneName = genes, OtherInfo = c(1,2,3)) map_gene_to_tss_using_gtf(genes = genes_df, gene_col = \"GeneName\", genome = \"hg19\") } # }"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_one_pair.html","id":null,"dir":"Reference","previous_headings":"","what":"perform_mr_for_one_pair — mr_one_pair","title":"perform_mr_for_one_pair — mr_one_pair","text":"perform_mr_for_one_pair perform MR one pair exp ","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_one_pair.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"perform_mr_for_one_pair — mr_one_pair","text":"","code":"mr_one_pair(   dat_h,   exp = \"\",   out = \"\",   save_plot = T,   res_dir = \"./output/tsmr\",   fig_dir = \"./figure/tsmr\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_one_pair.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"perform_mr_for_one_pair — mr_one_pair","text":"dat_h harmonized data exp str indicating exposure dat_h str indicating outcome dat_h save_plot save plot T, defaut T. res_dir dir path result fo MR analysis stored fig_dir dir path figure MR analysis stored","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_one_pair.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"perform_mr_for_one_pair — mr_one_pair","text":"list(res_pair=res_pair, res_pair_presso=res_pair_presso)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_one_pair.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"perform_mr_for_one_pair — mr_one_pair","text":"","code":"if (FALSE) { # \\dontrun{ # dat_h is harmonized TwoSampleMR data with columns: # exposure, outcome, mr_keep, beta.exposure, beta.outcome, etc. out <- mr_one_pair(   dat_h = dat_h,   exp = \"BMI\",   out = \"T1D\",   save_plot = FALSE,   res_dir = \"./output/tsmr\",   fig_dir = \"./figure/tsmr\" ) names(out) } # })"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_scatter_plot_modified.html","id":null,"dir":"Reference","previous_headings":"","what":"Modified MR Scatter Plot — mr_scatter_plot_modified","title":"Modified MR Scatter Plot — mr_scatter_plot_modified","text":"mr_scatter_plot TwoSampleMR package better. modified version mr_scatter_plot TwoSampleMR package slope two method really close, scatter plot may properly plot ! Change line type mannually herein .","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_scatter_plot_modified.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modified MR Scatter Plot — mr_scatter_plot_modified","text":"","code":"mr_scatter_plot_modified(mr_results, dat)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_scatter_plot_modified.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modified MR Scatter Plot — mr_scatter_plot_modified","text":"mr_results TwoSampleMR::mr_scatter_plot dat TwoSampleMR::mr_scatter_plot","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mr_scatter_plot_modified.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Modified MR Scatter Plot — mr_scatter_plot_modified","text":"","code":"p1 <- mr_scatter_plot_modified(mr_results = res_pair, dat = dat_h_pair) #> Error: object 'dat_h_pair' not found print(p1[[1]]) #> Error: object 'p1' not found library(ggplot2);library(ggsci);library(TwoSampleMR);library(dplyr) #> TwoSampleMR version 0.6.30  #>   [>] New authentication requirements: https://mrcieu.github.io/ieugwasr/articles/guide.html#authentication. #>   [>] Major upgrades to our servers completed to improve service and stability. #>   [>] We need your help to shape our emerging roadmap! #>       Please take 2 minutes to give us feedback - #>       https://forms.office.com/e/eSr7EFAfCG #>  #> Attaching package: ‘TwoSampleMR’ #> The following object is masked from ‘package:ieugwasr’: #>  #>     ld_matrix"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mrlap_one_pair.html","id":null,"dir":"Reference","previous_headings":"","what":"mrlap_one_pair — mrlap_one_pair","title":"mrlap_one_pair — mrlap_one_pair","text":"mrlap_one_pair perform MR-lap one pair exposure outcome MR-lap","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mrlap_one_pair.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mrlap_one_pair — mrlap_one_pair","text":"","code":"mrlap_one_pair(   exposure_data,   outcome_data,   exposure_name,   outcome_name,   ld_path,   hm3_path,   log = F,   log_path = \".\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/mrlap_one_pair.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mrlap_one_pair — mrlap_one_pair","text":"exposure_data exposure_data outcome_data outcome_data exposure_name exposure_name outcome_name outcome_name ld_path ldsc required file hm3_path ldsc required file; tutorial use nomhc version list log logi, T, save ldsc log log_path, defaut F log_path path wanna store ldsc log","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plink_clump_hla_aware.html","id":null,"dir":"Reference","previous_headings":"","what":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","title":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","text":"Simple wrapper: \"none\"       -> drop HLA (chr6:25–34Mb), clump non-HLA \"\"        -> keep HLA (clump), clump non-HLA, union \"just_clump\" -> clump variants together","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plink_clump_hla_aware.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","text":"","code":"plink_clump_hla_aware(   bfile,   hla_keep = c(\"all\", \"none\", \"just_clump\"),   output,   plink_bin = plinkbinr::get_plink_exe() )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plink_clump_hla_aware.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","text":"bfile PLINK bfile LD reference. hla_keep One c(\"\",\"none\",\"just_clump\"). output Output prefix; expects {output}.clump.txt. plink_bin Path PLINK.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plink_clump_hla_aware.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","text":"Character vector kept SNPs; also writes {output}.kept.snps.txt.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plink_clump_hla_aware.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HLA-aware PLINK clumping (Yet implemented) — plink_clump_hla_aware","text":"Input: {output}.clump.txt columns \"SNP\",\"P\". Defaults follow common PRS C+T: –clump-p1 1, –clump-p2 1, –clump-r2 0.1, –clump-kb 250.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot gsMap (full & highlight) with robust color mapping — plot_gsMap","title":"Plot gsMap (full & highlight) with robust color mapping — plot_gsMap","text":"Main plotting function. Full panel uses per-annotation colors; highlight panel keeps data greys non-highlighted levels.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot gsMap (full & highlight) with robust color mapping — plot_gsMap","text":"","code":"plot_gsMap(   path,   width1 = 6,   height1 = 4,   width2 = 8,   height2 = 4,   color = NULL,   anno_colors = NULL,   reverse_x = FALSE,   reverse_y = TRUE,   save_folder = \"./figure/gsmap/tmp\",   basename = NULL,   traitname = NULL,   highlight_tissue = NULL,   highlight_color = NULL,   other_grey = \"grey60\" )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot gsMap (full & highlight) with robust color mapping — plot_gsMap","text":"path CSV file path columns: sx, sy, annotation, logp. width1, height1 PDF size full-annotation figure. width2, height2 PDF size combined highlight+logp figure. color Named color vector annotations (fallback). anno_colors Preferred named color vector annotations (partial allowed). reverse_x, reverse_y Reverse axes . save_folder Output folder. basename Optional plot basename. traitname Optional trait name. highlight_tissue Levels highlight (default: first level missing). highlight_color Highlight color (single string named vector). other_grey Color used non-highlight levels highlight panel.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot gsMap (full & highlight) with robust color mapping — plot_gsMap","text":"","code":"# Simulate & write a small CSV set.seed(1) df <- data.frame(sx = rnorm(60), sy = rnorm(60),                  annotation = rep(c(\"Heart\",\"Liver\",\"Lung\",\"Brain\"), each = 15),                  logp = runif(60, 1, 12)) fp <- file.path(tempdir(), \"A_B_trait_gsMap_plot.csv\") write.csv(df, fp, row.names = FALSE)  # Partial colors; highlight Brain in gold; others grey anno_cols <- c(Heart = \"#E64B35FF\", Liver = \"#4DBBD5FF\") plot_gsMap(path = fp, width1 = 5, height1 = 3.5, width2 = 7, height2 = 3.5,            anno_colors = anno_cols, reverse_x = FALSE, reverse_y = TRUE,            save_folder = tempdir(), basename = \"Demo.Base\", traitname = \"trait\",            highlight_tissue = \"Brain\", highlight_color = \"#FFD700\", other_grey = \"grey60\") #> Error in plot_gsMap(path = fp, width1 = 5, height1 = 3.5, width2 = 7,     height2 = 3.5, anno_colors = anno_cols, reverse_x = FALSE,     reverse_y = TRUE, save_folder = tempdir(), basename = \"Demo.Base\",     traitname = \"trait\", highlight_tissue = \"Brain\", highlight_color = \"#FFD700\",     other_grey = \"grey60\"): could not find function \"plot_gsMap\""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap_color.html","id":null,"dir":"Reference","previous_headings":"","what":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","title":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","text":"gsMap_plot Helper build color mappings (partial fill, highlight override).","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap_color.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","text":"","code":"plot_gsMap_color(   annos,   anno_colors = NULL,   color = NULL,   highlight_tissue = NULL,   highlight_color = NULL )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap_color.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","text":"annos Character vector annotation levels (unique, ordered). anno_colors Named colors /levels (preferred color). color Named colors fallback anno_colors NULL. highlight_tissue Character vector levels highlight; fallback first annos none valid. highlight_color Single color string named vector mapping highlight levels colors.","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap_color.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","text":"list : final_map named colors annos auto-fill & highlight override (full plot) hi_levels chosen highlight levels hi_map named colors highlight levels (highlight-plot)","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/plot_gsMap_color.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build color maps for gsMap plots (helper function) — plot_gsMap_color","text":"","code":"library(patchwork) #> Error in library(patchwork): there is no package called ‘patchwork’ library(ggplot2) # Simulate a small dataframe df <- data.frame(sx = rnorm(30), sy = rnorm(30),                  annotation = rep(c(\"TissueA\",\"TissueB\",\"TissueC\"), each = 10),                  logp = runif(30, 1, 10))  # User provides partial colors; others will be auto-filled cm <- plot_gsMap_color(annos = unique(df$annotation),                        anno_colors = c(TissueA = \"#F2B701\"),                        highlight_tissue = \"TissueB\",                        highlight_color  = \"#FF0000\") #> Error in plot_gsMap_color(annos = unique(df$annotation), anno_colors = c(TissueA = \"#F2B701\"),     highlight_tissue = \"TissueB\", highlight_color = \"#FF0000\"): could not find function \"plot_gsMap_color\"  # Full plot (manual scale with final_map) gg <- ggplot2::ggplot(df, ggplot2::aes(sx, sy, color = annotation)) +   ggplot2::geom_point() +   ggplot2::scale_color_manual(values = cm$final_map) #> Error in cm$final_map: object of type 'closure' is not subsettable  # Highlight-only plot (only highlight levels mapped) gg_hi <- ggplot2::ggplot(df, ggplot2::aes(sx, sy, color = annotation)) +   ggplot2::geom_point() +   ggplot2::scale_color_manual(values = cm$hi_map, name = \"Highlight\") #> Error in cm$hi_map: object of type 'closure' is not subsettable gg | gg_hi #> Error: object 'gg' not found"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/process_gene_input.html","id":null,"dir":"Reference","previous_headings":"","what":"Process input data — process_gene_input","title":"Process input data — process_gene_input","text":"Process input data","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/process_gene_input.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process input data — process_gene_input","text":"","code":"process_gene_input(genes, gene_col)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/report_mapping_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Report mapping statistics — report_mapping_stats","title":"Report mapping statistics — report_mapping_stats","text":"Report mapping statistics","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/report_mapping_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Report mapping statistics — report_mapping_stats","text":"","code":"report_mapping_stats(ensembl_col)"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/save_regional_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Loci_plot: save_regional_plot — save_regional_plot","title":"Loci_plot: save_regional_plot — save_regional_plot","text":"Loci_plot: save_regional_plot","code":""},{"path":"https://laleoarrow.github.io/leo.gwas/reference/save_regional_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loci_plot: save_regional_plot — save_regional_plot","text":"","code":"save_regional_plot(   path,   loc,   gene,   save = T,   title = expression(paste(italic(\"CLPSL1\"), \" (T1D)\")),   labels = c(\"index\"),   filter_gene_biotype = c(\"protein_coding\"),   border = F,   width = 7.5,   height = 5.5 )"},{"path":"https://laleoarrow.github.io/leo.gwas/reference/save_regional_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loci_plot: save_regional_plot — save_regional_plot","text":"path path store plot; make sure path exist loc output locuszoomr_loc gene gene save T, save plot path; F, return plot labels labels; case need indicate index SNP SNP border border gene track width width height height","code":""}]
